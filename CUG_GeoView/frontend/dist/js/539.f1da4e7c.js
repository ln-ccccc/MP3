"use strict";(self["webpackChunkgeoview"]=self["webpackChunkgeoview"]||[]).push([[539],{8068:function(e,l,i){i.r(l),i.d(l,{default:function(){return A}});var t=i(6768),s=i(4232);const o={key:0,class:"clear-queue"},a={class:"prehandle-label container"},n={class:"custom-model"},d={key:0},r={class:"handle-button"},c={class:"go-bold"},u={class:"restore-img-box"},h=["src"],p={class:"img-wrapper"},g=["src"],f={class:"choose-restore"},m={key:1},k=["onClick"],b={style:{"text-align":"center"}},L={style:{"text-align":"center"}};function v(e,l,i,v,y,_){const C=(0,t.g2)("Tabinfor"),w=(0,t.g2)("el-divider"),M=(0,t.g2)("el-button"),F=(0,t.g2)("el-upload"),S=(0,t.g2)("el-row"),x=(0,t.g2)("el-radio"),U=(0,t.g2)("el-card"),W=(0,t.g2)("el-col"),A=(0,t.g2)("MyVueCropper"),I=(0,t.g2)("el-dialog"),j=(0,t.g2)("el-empty"),X=(0,t.g2)("el-image"),V=(0,t.g2)("Bottominfor");return(0,t.uX)(),(0,t.CE)("div",null,[(0,t.bF)(C,null,{left:(0,t.k6)(()=>[...l[15]||(l[15]=[(0,t.Lk)("div",{id:"sub-title"},[(0,t.eW)(" 影像超分重建"),(0,t.Lk)("i",{class:"iconfont icon-dianji"})],-1)])]),_:1}),(0,t.bF)(w),l[30]||(l[30]=(0,t.Fv)('<p data-v-66958588> 请上传包含<span class="go-bold" data-v-66958588>图片的文件夹</span><i class="iconfont icon-wenjianjia" data-v-66958588></i>或者<span class="go-bold" data-v-66958588>图片</span><i class="iconfont icon-tupiantianjia" data-v-66958588></i>，<i class="iconfont icon-zidingyi" data-v-66958588></i></p>',1)),(0,t.bF)(S,{type:"flex",justify:"center"},{default:(0,t.k6)(()=>[(0,t.bF)(W,{span:24},{default:(0,t.k6)(()=>[(0,t.bF)(U,{style:{border:"4px dashed var(--el-border-color)"}},{default:(0,t.k6)(()=>[y.fileList.length?((0,t.uX)(),(0,t.CE)("div",o,[(0,t.bF)(M,{type:"primary",class:"btn-animate2 btn-animate__surround",onClick:_.clearQueue},{default:(0,t.k6)(()=>[...l[16]||(l[16]=[(0,t.eW)(" 清空图片 ",-1)])]),_:1},8,["onClick"])])):(0,t.Q3)("",!0),(0,t.bF)(F,{ref:"upload","file-list":y.fileList,"onUpdate:fileList":l[0]||(l[0]=e=>y.fileList=e),class:"upload-card",drag:"",action:"#",multiple:"","auto-upload":!1,onChange:l[1]||(l[1]=e=>_.beforeUpload(y.fileList[y.fileList.length-1].raw))},{default:(0,t.k6)(()=>[...l[17]||(l[17]=[(0,t.Lk)("i",{class:"iconfont icon-yunduanshangchuan"},null,-1),(0,t.Lk)("div",{class:"el-upload__text"},[(0,t.eW)(" 将文件拖到此处，或"),(0,t.Lk)("em",null,"点击上传")],-1),(0,t.Lk)("div",{class:"el-upload__tip"}," 只能上传一张或多张图片，请在下方上传文件夹 ",-1)])]),_:1},8,["file-list"]),(0,t.bF)(S,{justify:"center"},{default:(0,t.k6)(()=>[(0,t.Lk)("input",{id:"folder",ref:"uploadFile",type:"file",webkitdirectory:"",directory:"",multiple:"",onChange:l[2]||(l[2]=e=>_.uploadMore())},null,544),(0,t.Lk)("i",{class:"iconfont icon-wenjianshangchuan",onClick:l[3]||(l[3]=(...e)=>_.fileClick&&_.fileClick(...e))},"上传文件夹")]),_:1}),(0,t.bF)(S,{justify:"center"},{default:(0,t.k6)(()=>[(0,t.Lk)("p",null,[(0,t.Lk)("label",a,[(0,t.Lk)("input",{ref:"cut",type:"checkbox",onChange:l[4]||(l[4]=e=>_.select())},null,544),l[18]||(l[18]=(0,t.Lk)("span",{class:"checkmark"},null,-1)),l[19]||(l[19]=(0,t.Lk)("span",{class:"go-bold label-words"},"上传时编辑图片",-1)),l[20]||(l[20]=(0,t.Lk)("i",{class:"iconfont icon-crop-full"},null,-1))])])]),_:1}),(0,t.bF)(S,{justify:"center"},{default:(0,t.k6)(()=>[(0,t.Lk)("div",n,[l[21]||(l[21]=(0,t.eW)(" 可选训练模型： ",-1)),0===y.modelPathArr.length?((0,t.uX)(),(0,t.CE)("span",d,"未检测到模型文件，请查看上传目录是否有误")):(0,t.Q3)("",!0),((0,t.uX)(!0),(0,t.CE)(t.FK,null,(0,t.pI)(y.modelPathArr,(e,i)=>((0,t.uX)(),(0,t.Wv)(x,{key:i,modelValue:y.uploadSrc.model_path,"onUpdate:modelValue":l[5]||(l[5]=e=>y.uploadSrc.model_path=e),class:"choose-item",label:e.model_path},{default:(0,t.k6)(()=>[(0,t.eW)((0,s.v_)(e.model_name),1)]),_:2},1032,["modelValue","label"]))),128))])]),_:1}),(0,t.Lk)("div",r,[(0,t.bF)(M,{type:"primary",class:"btn-animate btn-animate__shiny",onClick:l[6]||(l[6]=e=>_.upload("影像超分重建","image_restoration"))},{default:(0,t.k6)(()=>[...l[22]||(l[22]=[(0,t.eW)(" 开始处理 ",-1)])]),_:1})])]),_:1})]),_:1})]),_:1}),(0,t.bF)(C,null,{left:(0,t.k6)(()=>[...l[23]||(l[23]=[(0,t.Lk)("div",{id:"sub-title"},[(0,t.eW)(" 结果图预览"),(0,t.Lk)("i",{class:"iconfont icon-dianji"})],-1)])]),_:1}),(0,t.bF)(w),(0,t.bF)(C,null,{left:(0,t.k6)(()=>[...l[24]||(l[24]=[(0,t.Lk)("p",null,[(0,t.Lk)("span",{class:"go-bold"},"点击图片"),(0,t.eW)("即可预览 "),(0,t.Lk)("i",{class:"iconfont icon-duigou"}),(0,t.Lk)("span",null,[(0,t.Lk)("span",{class:"go-bold"},"滑轮滚动"),(0,t.eW)("即可放大缩小")])],-1)])]),right:(0,t.k6)(()=>[(0,t.Lk)("span",c,[(0,t.Lk)("i",{class:"iconfont icon-shuaxin",style:{"padding-right":"55px"},onClick:l[7]||(l[7]=(...e)=>_.getMore&&_.getMore(...e))},[...l[25]||(l[25]=[(0,t.Lk)("span",{class:"hidden-sm-and-down"},"点击刷新",-1)])])])]),_:1}),(0,t.bF)(I,{modelValue:y.cutVisible,"onUpdate:modelValue":l[8]||(l[8]=e=>y.cutVisible=e),modal:!1,title:"编辑",width:"75%",top:"0"},{default:(0,t.k6)(()=>[(0,t.bF)(A,{fileimg:y.fileimg,funtype:y.funtype,file:y.file,child_prehandle:y.uploadSrc.prehandle,child_denoise:y.uploadSrc.denoise,"child-model-path":y.uploadSrc.model_path,onCutChanged:_.notvisible,onChildRefresh:_.getMore},null,8,["fileimg","funtype","file","child_prehandle","child_denoise","child-model-path","onCutChanged","onChildRefresh"])]),_:1},8,["modelValue"]),(0,t.bF)(U,null,{default:(0,t.k6)(()=>[(0,t.Lk)("div",u,[(0,t.Lk)("div",null,[y.isUpload?((0,t.uX)(),(0,t.CE)("div",{key:1,id:"image-slider",onMousemove:l[9]||(l[9]=(...e)=>_.sliderMouseMove&&_.sliderMouseMove(...e)),onMousedown:l[10]||(l[10]=(...e)=>_.sliderMouseDown&&_.sliderMouseDown(...e)),onMouseup:l[11]||(l[11]=(...e)=>_.sliderMouseUp&&_.sliderMouseUp(...e)),onMouseleave:l[12]||(l[12]=(...e)=>_.sliderMouseLeave&&_.sliderMouseLeave(...e))},[(0,t.Lk)("img",{src:y.imgArr[y.currentIndex]?.before_img,alt:""},null,8,h),(0,t.Lk)("div",p,[(0,t.Lk)("img",{src:y.imgArr[y.currentIndex]?.after_img,alt:""},null,8,g)]),l[26]||(l[26]=(0,t.Lk)("div",{class:"handle"},[(0,t.Lk)("div",{class:"handle-line"}),(0,t.Lk)("div",{class:"handle-circle"}," «» "),(0,t.Lk)("div",{class:"handle-line"})],-1))],32)):((0,t.uX)(),(0,t.Wv)(j,{key:0,"image-size":300}))]),(0,t.Lk)("div",f,[(0,t.bF)(w,{style:{"margin-top":"0"}}),l[29]||(l[29]=(0,t.Lk)("div",{class:"style-title"}," 选择图片 ",-1)),y.isUpload?((0,t.uX)(),(0,t.CE)("div",m,[((0,t.uX)(!0),(0,t.CE)(t.FK,null,(0,t.pI)(Math.ceil(y.imgArr.length/5),(e,l)=>((0,t.uX)(),(0,t.CE)("div",{key:l,class:"list"},[(0,t.Lk)("div",{class:"list-number",onClick:e=>_.goShowThese(l)},(0,s.v_)(5*l+1)+"-----"+(0,s.v_)(5*(l+1)),9,k)]))),128)),(0,t.Lk)("div",b,[l[28]||(l[28]=(0,t.eW)(" 下载此图片：",-1)),(0,t.bF)(M,{type:"primary",style:{width:"60px"},class:"btn-animate btn-animate__shiny",onClick:l[13]||(l[13]=e=>_.downloadimgWithWords(y.imgArr[y.currentIndex].id,y.imgArr[y.currentIndex].after_img,"影像超分重建结果图.png"))},{default:(0,t.k6)(()=>[...l[27]||(l[27]=[(0,t.eW)(" 下载 ",-1)])]),_:1}),(0,t.Lk)("p",L,[(0,t.Lk)("span",null,[(0,t.Lk)("i",{class:"iconfont icon-dabaoxiazai",onClick:l[14]||(l[14]=e=>_.goCompress("影像超分重建"))},"所有结果图打包")])])])])):((0,t.uX)(),(0,t.Wv)(j,{key:0,"image-size":100}))])]),(0,t.bF)(S,{class:"swiper-img"},{default:(0,t.k6)(()=>[((0,t.uX)(),(0,t.CE)(t.FK,null,(0,t.pI)(5,(e,l)=>(0,t.Lk)("div",{key:l,class:"img-box"},[y.imgArr[y.currentQroup+l]?.after_img?((0,t.uX)(),(0,t.Wv)(X,{key:0,src:y.imgArr[y.currentQroup+l]?.after_img,class:(0,s.C4)({"render-border":y.onRender===l}),onClick:e=>_.goShowThis(l)},null,8,["src","class","onClick"])):(0,t.Q3)("",!0)])),64))]),_:1})]),_:1}),(0,t.bF)(V)])}i(4114),i(4603),i(7566),i(8721);var y=i(9857),_=i(2564),C=i(121),w=i(3361),M=i(104),F=i(3490),S=i(6926),x={name:"Restoreimgs",components:{Tabinfor:M.A,Bottominfor:F.A,MyVueCropper:S.A},beforeRouteEnter(e,l,i){i(e=>{document.querySelector(".el-main").scrollTop=0})},data(){return{canUpload:!0,fileimg:"",file:{},isNotCut:!0,cutVisible:!1,funtype:"影像超分重建",scrollTop:"",fit:"fill",fileList:[],uploadSrc:{list:[],model_path:""},modelPathArr:[],isSliderLocked:!1,onRender:0,currentIndex:0,currentQroup:0,imgArr:[],isUpload:!1}},watch:{uploadSrc:{handler(e,l){this.uploadSrc=e},deep:!0,immediate:!0},isUpload:{handler(e,l){this.isUpload=e}}},created(){this.getUploadImg("影像超分重建"),this.getCustomModel("image_restoration").then(e=>{this.modelPathArr=e.data.data,this.uploadSrc.model_path=this.modelPathArr[0]?.model_path}).catch(e=>{})},methods:{imgUpload:y.vh,getCustomModel:y.bB,historyGetPage:_.q,createSrc:y.Dr,getUploadImg:C.Be,upload:C.Se,downloadimgWithWords:w.Lf,getImgArrayBuffer:w.h0,atchDownload:w.hz,goCompress:C.xX,clearQueue(){this.fileList=[],this.$message.success("清除成功")},notvisible(){this.cutVisible=!1,this.fileList=[]},getMore(){this.getUploadImg("影像超分重建"),this.goShowThese(0),console.log(this.imgArr.length)},uploadMore(){this.beforeUpload(...this.$refs.uploadFile.files),this.canUpload?this.fileList.push(...this.$refs.uploadFile.files):setTimeout(()=>{this.$message.error("检测到您上传的文件夹内存在不符合规范的图片类型")},1e3)},fileClick(){document.querySelector("#folder").click()},beforeUpload(e){this.cutVisible=this.$refs.cut.checked;const l=e.name.substring(e.name.lastIndexOf(".")+1),i=["jpg","jpeg","png","JPG","JPEG"];-1===i.indexOf(l)?(this.$message.error("只允许上传jpg, jpeg, png, JPG, 或JPEG格式,请重新上传"),this.fileList=[],this.canUpload=!1,this.cutVisible=!1):(this.canUpload=!0,this.fileimg=window.URL.createObjectURL(new Blob([e])))},select(){this.isNotCut=this.$refs.cut.checked},goShowThis(e){this.currentIndex=this.currentQroup,this.currentIndex+=e,this.onRender=e},goShowThese(e){this.currentQroup=5*e,this.currentIndex=5*e,this.goShowThis(0)},sliderMouseMove(e){const l=document.querySelector("#image-slider"),i=document.querySelector(".img-wrapper"),t=document.querySelector(".handle");if(this.isSliderLocked)return;const s=l.offsetLeft,o=l.clientWidth,a=t.clientWidth;let n=e.clientX-s;n<0?n=0:n>o&&(n=o),i.style.width=`${(100*(1-n/o)).toFixed(4)}%`,t.style.left=`calc(${(n/o*100).toFixed(4)}% - ${a/2}px)`},sliderMouseDown(){this.isSliderLocked&&(this.isSliderLocked=!1),this.sliderMouseMove(event)},sliderMouseUp(){this.isSliderLocked||(this.isSliderLocked=!0)},sliderMouseLeave(){this.isSliderLocked&&(this.isSliderLocked=!1)}}},U=i(1241);const W=(0,U.A)(x,[["render",v],["__scopeId","data-v-66958588"]]);var A=W}}]);
//# sourceMappingURL=539.f1da4e7c.js.map