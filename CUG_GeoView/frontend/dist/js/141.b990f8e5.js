"use strict";(self["webpackChunkgeoview"]=self["webpackChunkgeoview"]||[]).push([[141],{1818:function(e,l,s){s.d(l,{Mx:function(){return a},dx:function(){return o},nK:function(){return c},sw:function(){return n}});s(8111),s(2489),s(1701);var i=s(9857),t=s(3212);function a(e){if(0===this.fileList.length)4===this.uploadSrc.prehandle?(this.$refs.sharpen.checked=!1,this.uploadSrc.prehandle=0):(this.$refs.sharpen.checked=!1,this.$message.error("请先上传图片"));else if(!0===this.$refs.clahe.checked&&(this.$refs.clahe.checked=!1),!1===this.$refs.sharpen.checked)this.$message.success("取消锐化处理"),this.uploadSrc.prehandle=0;else{this.$message.success("锐化处理"),this.uploadSrc.prehandle=4;let l=new FormData;for(const s of this.fileList)l.append("files",s)||l.append("files",s.raw),l.append("type",e);(0,i.Dr)(l).then(e=>{this.uploadSrc.list=e.data.data.map(e=>t.A.BASEURL+e.src),this.before=this.uploadSrc.list.splice(0,3),this.prePhoto.list=this.before,this.prePhoto.prehandle=4,(0,i.WS)(this.prePhoto).then(e=>{this.sharpenImg=e.data.data.map(e=>t.A.BASEURL+e)}).catch(()=>{})}).catch(e=>{})}}function n(e){if(0===this.fileList.length)2===this.uploadSrc.prehandle?(this.$refs.clahe.checked=!1,this.uploadSrc.prehandle=0):(this.$refs.clahe.checked=!1,this.$message.error("请先上传图片"));else if(!0===this.$refs.sharpen.checked&&(this.$refs.sharpen.checked=!1),!1===this.$refs.clahe.checked)this.$message.success("取消CLAHE处理"),this.uploadSrc.prehandle=0;else{this.$message.success("CLAHE处理"),this.uploadSrc.prehandle=2;let l=new FormData;for(const s of this.fileList)l.append("files",s)||l.append("files",s.raw),l.append("type",e);(0,i.Dr)(l).then(e=>{this.uploadSrc.list=e.data.data.map(e=>t.A.BASEURL+e.src),this.before=this.uploadSrc.list.splice(0,3),this.prePhoto.list=this.before,this.prePhoto.prehandle=2,(0,i.WS)(this.prePhoto).then(e=>{this.claheImg=e.data.data.map(e=>t.A.BASEURL+e)}).catch(e=>{})}).catch(e=>{})}}function o(){!0===this.$refs.smooth.checked&&(this.$refs.smooth.checked=!1),!1===this.$refs.filter.checked?(this.$message.success("取消高斯滤波处理"),this.uploadSrc.denoise=0):(this.$message.success("高斯滤波处理"),this.uploadSrc.denoise=5)}function c(){!0===this.$refs.filter.checked&&(this.$refs.filter.checked=!1),!1===this.$refs.smooth.checked?(this.$message.success("取消平滑处理"),this.uploadSrc.denoise=0):(this.$message.success("平滑处理"),this.uploadSrc.denoise=3)}},2198:function(e,l,s){s.r(l),s.d(l,{default:function(){return U}});var i=s(6768),t=s(4232);const a={key:0,class:"clear-queue"},n={class:"prehandle-label container"},o={class:"prehandle-label container"},c={class:"prehandle-label container"},r={class:"prehandle-label container"},d={class:"prehandle-label container"},h={class:"custom-model"},p={key:0},u={class:"handle-button"},f={key:2},k={key:0},g={key:1},m={class:"handle-words"},b=["onClick"],L={class:"handle-words"},v=["onClick"],y={class:"go-bold"};function C(e,l,s,C,_,w){const S=(0,i.g2)("Tabinfor"),F=(0,i.g2)("el-divider"),A=(0,i.g2)("el-button"),W=(0,i.g2)("el-upload"),x=(0,i.g2)("el-row"),$=(0,i.g2)("el-radio"),E=(0,i.g2)("el-image"),I=(0,i.g2)("el-col"),j=(0,i.g2)("el-card"),X=(0,i.g2)("MyVueCropper"),U=(0,i.g2)("el-dialog"),P=(0,i.g2)("ImgShow"),V=(0,i.g2)("Bottominfor");return(0,i.uX)(),(0,i.CE)("div",null,[(0,i.bF)(S,null,{left:(0,i.k6)(()=>[...l[13]||(l[13]=[(0,i.Lk)("div",{id:"sub-title"},[(0,i.eW)(" 地物分类"),(0,i.Lk)("i",{class:"iconfont icon-dianji"})],-1)])]),_:1}),(0,i.bF)(F),l[43]||(l[43]=(0,i.Lk)("p",null,[(0,i.eW)(" 请上传包含"),(0,i.Lk)("span",{class:"go-bold"},"图片的文件夹"),(0,i.Lk)("i",{class:"iconfont icon-wenjianjia"}),(0,i.eW)("或者"),(0,i.Lk)("span",{class:"go-bold"},"图片"),(0,i.Lk)("i",{class:"iconfont icon-tupiantianjia"})],-1)),(0,i.bF)(x,{type:"flex",justify:"space-evenly"},{default:(0,i.k6)(()=>[(0,i.bF)(I,{span:24},{default:(0,i.k6)(()=>[(0,i.bF)(j,{style:{border:"4px dashed var(--el-border-color)"}},{default:(0,i.k6)(()=>[_.fileList.length?((0,i.uX)(),(0,i.CE)("div",a,[(0,i.bF)(A,{type:"primary",class:"btn-animate2 btn-animate__surround",onClick:w.clearQueue},{default:(0,i.k6)(()=>[...l[14]||(l[14]=[(0,i.eW)(" 清空图片 ",-1)])]),_:1},8,["onClick"])])):(0,i.Q3)("",!0),(0,i.bF)(W,{ref:"upload","file-list":_.fileList,"onUpdate:fileList":l[0]||(l[0]=e=>_.fileList=e),class:"upload-card",drag:"",action:"#",multiple:"",accpet:".jpg,.jpeg,.png,.JPG,.JPEG","auto-upload":!1,onChange:l[1]||(l[1]=e=>w.beforeUpload(_.fileList[_.fileList.length-1].raw))},{default:(0,i.k6)(()=>[...l[15]||(l[15]=[(0,i.Lk)("i",{class:"iconfont icon-yunduanshangchuan"},null,-1),(0,i.Lk)("div",{class:"el-upload__text"},[(0,i.eW)(" 将图片拖到此处，或"),(0,i.Lk)("em",null,"点击上传")],-1),(0,i.Lk)("div",{class:"el-upload__tip"}," 只能上传一张或多张图片，请在下方上传文件夹 ",-1)])]),_:1},8,["file-list"]),(0,i.bF)(x,{justify:"center"},{default:(0,i.k6)(()=>[(0,i.Lk)("input",{id:"folder",ref:"uploadFile",type:"file",webkitdirectory:"",directory:"",multiple:"",onChange:l[2]||(l[2]=e=>w.uploadMore())},null,544),(0,i.Lk)("i",{class:"iconfont icon-wenjianshangchuan",onClick:l[3]||(l[3]=(...e)=>w.fileClick&&w.fileClick(...e))},"上传文件夹")]),_:1}),(0,i.bF)(x,{justify:"center"},{default:(0,i.k6)(()=>[(0,i.Lk)("p",null,[(0,i.Lk)("label",n,[(0,i.Lk)("input",{ref:"cut",type:"checkbox",onChange:l[4]||(l[4]=e=>w.select())},null,544),l[16]||(l[16]=(0,i.Lk)("span",{class:"checkmark"},null,-1)),l[17]||(l[17]=(0,i.Lk)("span",{class:"go-bold label-words"},"上传时编辑图片",-1)),l[18]||(l[18]=(0,i.Lk)("i",{class:"iconfont icon-crop-full"},null,-1))])])]),_:1}),(0,i.bF)(x,{justify:"center",align:"middle"},{default:(0,i.k6)(()=>[l[23]||(l[23]=(0,i.Lk)("i",{class:"iconfont icon-tuxingtuxiangchuli"},null,-1)),l[24]||(l[24]=(0,i.Lk)("p",null,"图像增强：",-1)),(0,i.Lk)("p",null,[(0,i.Lk)("label",o,[(0,i.Lk)("input",{ref:"clahe",type:"checkbox",onChange:l[5]||(l[5]=e=>w.selectClahe(4))},null,544),l[19]||(l[19]=(0,i.Lk)("span",{class:"checkmark"},null,-1)),l[20]||(l[20]=(0,i.Lk)("span",{class:"go-bold label-words"},"CLAHE",-1))])]),(0,i.Lk)("p",null,[(0,i.Lk)("label",c,[(0,i.Lk)("input",{ref:"sharpen",type:"checkbox",onChange:l[6]||(l[6]=e=>w.selectSharpen(4))},null,544),l[21]||(l[21]=(0,i.Lk)("span",{class:"checkmark"},null,-1)),l[22]||(l[22]=(0,i.Lk)("span",{class:"go-bold label-words"},"锐化",-1))])])]),_:1}),(0,i.bF)(x,{justify:"center",align:"middle"},{default:(0,i.k6)(()=>[l[29]||(l[29]=(0,i.Lk)("i",{class:"iconfont icon-agora_AIjiangzao"},null,-1)),l[30]||(l[30]=(0,i.Lk)("p",null,"降噪处理：",-1)),(0,i.Lk)("p",null,[(0,i.Lk)("label",r,[(0,i.Lk)("input",{ref:"smooth",type:"checkbox",onChange:l[7]||(l[7]=e=>w.selectSmooth())},null,544),l[25]||(l[25]=(0,i.Lk)("span",{class:"checkmark"},null,-1)),l[26]||(l[26]=(0,i.Lk)("span",{class:"go-bold label-words"},"平滑",-1))]),(0,i.Lk)("label",d,[(0,i.Lk)("input",{ref:"filter",type:"checkbox",onChange:l[8]||(l[8]=e=>w.selectFilter())},null,544),l[27]||(l[27]=(0,i.Lk)("span",{class:"checkmark"},null,-1)),l[28]||(l[28]=(0,i.Lk)("span",{class:"go-bold label-words"},"滤波",-1))])])]),_:1}),(0,i.bF)(x,{justify:"center"},{default:(0,i.k6)(()=>[(0,i.Lk)("div",h,[l[31]||(l[31]=(0,i.eW)(" 可选训练模型： ",-1)),0===_.modelPathArr.length?((0,i.uX)(),(0,i.CE)("span",p,"未检测到模型文件，请查看上传目录是否有误")):(0,i.Q3)("",!0),((0,i.uX)(!0),(0,i.CE)(i.FK,null,(0,i.pI)(_.modelPathArr,(e,s)=>((0,i.uX)(),(0,i.Wv)($,{key:s,modelValue:_.uploadSrc.model_path,"onUpdate:modelValue":l[9]||(l[9]=e=>_.uploadSrc.model_path=e),class:"choose-item",label:e.model_path},{default:(0,i.k6)(()=>[(0,i.eW)((0,t.v_)(e.model_name),1)]),_:2},1032,["modelValue","label"]))),128))])]),_:1}),(0,i.Lk)("div",u,[(0,i.bF)(A,{type:"primary",class:"btn-animate btn-animate__shiny",onClick:l[10]||(l[10]=e=>w.upload("地物分类","semantic_segmentation"))},{default:(0,i.k6)(()=>[...l[32]||(l[32]=[(0,i.eW)(" 开始处理 ",-1)])]),_:1})]),_.uploadSrc.prehandle?(0,i.Q3)("",!0):((0,i.uX)(),(0,i.Wv)(F,{key:1})),_.uploadSrc.prehandle?((0,i.uX)(),(0,i.CE)("div",f,[2===_.uploadSrc.prehandle?((0,i.uX)(),(0,i.CE)("div",k,[...l[33]||(l[33]=[(0,i.Lk)("div",{id:"sub-title"},[(0,i.eW)(" CLAHE处理结果预览"),(0,i.Lk)("i",{class:"iconfont icon-dianji"})],-1)])])):4===_.uploadSrc.prehandle?((0,i.uX)(),(0,i.CE)("div",g,[...l[34]||(l[34]=[(0,i.Lk)("div",{id:"sub-title"},[(0,i.eW)(" 锐化处理结果预览"),(0,i.Lk)("i",{class:"iconfont icon-dianji"})],-1)])])):(0,i.Q3)("",!0),(0,i.bF)(F),(0,i.bF)(x,{justify:"center",gutter:20},{default:(0,i.k6)(()=>[(0,i.bF)(I,{xs:24,sm:24,md:6,lg:6,xl:6},{default:(0,i.k6)(()=>[((0,i.uX)(!0),(0,i.CE)(i.FK,null,(0,i.pI)(_.before,(e,s)=>((0,i.uX)(),(0,i.CE)("div",{key:s},[(0,i.bF)(E,{src:e,"preview-src-list":[e],"preview-teleported":!0},null,8,["src","preview-src-list"]),l[35]||(l[35]=(0,i.Lk)("div",{class:"handle-words"}," 原图 ",-1))]))),128))]),_:1}),(0,i.bF)(I,{md:2,lg:2,xl:2}),2===_.uploadSrc.prehandle?((0,i.uX)(),(0,i.Wv)(I,{key:0,xs:24,sm:24,md:6,lg:6,xl:6},{default:(0,i.k6)(()=>[((0,i.uX)(!0),(0,i.CE)(i.FK,null,(0,i.pI)(_.claheImg,(e,s)=>((0,i.uX)(),(0,i.CE)("div",{key:s},[(0,i.bF)(E,{src:e,"preview-src-list":[e],"preview-teleported":!0},null,8,["src","preview-src-list"]),(0,i.Lk)("div",m,[l[37]||(l[37]=(0,i.eW)(" CLAHE处理后 ",-1)),(0,i.Lk)("span",{onClick:l=>w.downloadimgWithWords(-1,e,"CLAHE处理图.png")},[...l[36]||(l[36]=[(0,i.Lk)("i",{class:"iconfont icon-xiazai"},null,-1)])],8,b)])]))),128))]),_:1})):(0,i.Q3)("",!0),4===_.uploadSrc.prehandle?((0,i.uX)(),(0,i.Wv)(I,{key:1,xs:24,sm:24,md:6,lg:6,xl:6},{default:(0,i.k6)(()=>[((0,i.uX)(!0),(0,i.CE)(i.FK,null,(0,i.pI)(_.sharpenImg,(e,s)=>((0,i.uX)(),(0,i.CE)("div",{key:s},[(0,i.bF)(E,{src:e,"preview-src-list":[e],"preview-teleported":!0},null,8,["src","preview-src-list"]),(0,i.Lk)("div",L,[l[39]||(l[39]=(0,i.eW)(" 锐化处理后 ",-1)),(0,i.Lk)("span",{onClick:l=>w.downloadimgWithWords(-1,e,"锐化处理图.png")},[...l[38]||(l[38]=[(0,i.Lk)("i",{class:"iconfont icon-xiazai"},null,-1)])],8,v)])]))),128))]),_:1})):(0,i.Q3)("",!0)]),_:1})])):(0,i.Q3)("",!0)]),_:1})]),_:1})]),_:1}),(0,i.bF)(S,null,{left:(0,i.k6)(()=>[...l[40]||(l[40]=[(0,i.Lk)("div",{id:"sub-title"},[(0,i.eW)(" 结果图预览"),(0,i.Lk)("i",{class:"iconfont icon-dianji"})],-1)])]),_:1}),(0,i.bF)(F),(0,i.bF)(S,null,{left:(0,i.k6)(()=>[...l[41]||(l[41]=[(0,i.Lk)("p",null,[(0,i.Lk)("span",{class:"go-bold"},"点击图片"),(0,i.eW)("即可预览 "),(0,i.Lk)("i",{class:"iconfont icon-duigou"}),(0,i.Lk)("span",null,[(0,i.Lk)("span",{class:"go-bold"},"滑轮滚动"),(0,i.eW)("即可放大缩小")])],-1)])]),right:(0,i.k6)(()=>[(0,i.Lk)("div",y,[(0,i.Lk)("i",{class:"iconfont icon-shuaxin",style:{"padding-right":"65px"},onClick:l[11]||(l[11]=(...e)=>w.getMore&&w.getMore(...e))},[...l[42]||(l[42]=[(0,i.Lk)("span",{class:"hidden-sm-and-down"},"点击刷新",-1)])])])]),_:1}),(0,i.bF)(U,{modelValue:_.cutVisible,"onUpdate:modelValue":l[12]||(l[12]=e=>_.cutVisible=e),modal:!1,title:"编辑",width:"75%",top:"0"},{default:(0,i.k6)(()=>[(0,i.bF)(X,{fileimg:_.fileimg,funtype:_.funtype,file:_.file,"child-prehandle":_.uploadSrc.prehandle,"child-denoise":_.uploadSrc.denoise,"child-model-path":_.uploadSrc.model_path,onCutChanged:w.notvisible,onChildRefresh:w.getMore},null,8,["fileimg","funtype","file","child-prehandle","child-denoise","child-model-path","onCutChanged","onChildRefresh"])]),_:1},8,["modelValue"]),(0,i.bF)(P,{"img-arr":_.imgArr},null,8,["img-arr"]),(0,i.bF)(V)])}s(4114),s(4603),s(7566),s(8721);var _=s(3361),w=s(9857),S=s(2564),F=s(121),A=s(1818),W=s(7901),x=s(104),$=s(3490),E=s(6926),I={name:"Segmentation",components:{ImgShow:W.A,Tabinfor:x.A,Bottominfor:$.A,MyVueCropper:E.A},beforeRouteEnter(e,l,s){s(e=>{document.querySelector(".el-main").scrollTop=0})},data(){return{isUpload:!0,canUpload:!0,claheImg:[],sharpenImg:[],before:[],fileimg:"",file:{},isNotCut:!0,cutVisible:!1,fileList:[],funtype:"地物分类",scrollTop:"",fit:"fill",uploadSrc:{list:[],prehandle:0,denoise:0,model_path:""},modelPathArr:[],prePhoto:{list:[],prehandle:0,type:4},imgArr:[]}},watch:{uploadSrc:{handler(e,l){this.uploadSrc=e},deep:!0,immediate:!0}},created(){this.getUploadImg("地物分类"),this.getCustomModel("semantic_segmentation").then(e=>{this.modelPathArr=e.data.data,this.uploadSrc.model_path=this.modelPathArr[0]?.model_path}).catch(e=>{})},methods:{getImgArrayBuffer:_.h0,atchDownload:_.hz,imgUpload:w.vh,getCustomModel:w.bB,historyGetPage:S.q,createSrc:w.Dr,getUploadImg:F.Be,upload:F.Se,goCompress:F.xX,selectSharpen:A.Mx,selectFilter:A.dx,selectSmooth:A.nK,selectClahe:A.sw,downloadimgWithWords:_.Lf,checkUpload(){this.isUpload=0!==this.afterImg.length},clearQueue(){this.fileList=[],this.$message.success("清除成功")},notvisible(){this.cutVisible=!1,this.fileList=[]},uploadMore(){this.beforeUpload(...this.$refs.uploadFile.files),this.canUpload?this.fileList.push(...this.$refs.uploadFile.files):setTimeout(()=>{this.$message.error("检测到您上传的文件夹内存在不符合规范的图片类型")},1e3)},getMore(){this.getUploadImg("地物分类")},fileClick(){document.querySelector("#folder").click()},beforeUpload(e){this.cutVisible=this.$refs.cut.checked;const l=e.name.substring(e.name.lastIndexOf(".")+1),s=["jpg","jpeg","png","JPG","JPEG"];-1===s.indexOf(l)?(this.$message.error("只允许上传jpg, jpeg, png, JPG, 或JPEG格式,请重新上传"),this.fileList=[],this.cutVisible=!1,this.canUpload=!1):(this.canUpload=!0,this.fileimg=window.URL.createObjectURL(new Blob([e])))},select(){this.isNotCut=this.$refs.cut.checked}}},j=s(1241);const X=(0,j.A)(I,[["render",C],["__scopeId","data-v-a7832c90"]]);var U=X},7901:function(e,l,s){s.d(l,{A:function(){return m}});var i=s(6768),t=s(4232);const a={class:"img-display-box"},n={class:"index-number"},o={key:0},c={class:"img-infor"},r=["onClick"],d={key:1,class:"img-index"},h={class:"index-number"};function p(e,l,s,p,u,f){const k=(0,i.g2)("el-empty"),g=(0,i.g2)("el-divider"),m=(0,i.g2)("el-image"),b=(0,i.g2)("el-card");return(0,i.uX)(),(0,i.Wv)(b,{style:{"margin-bottom":"10px"}},{default:(0,i.k6)(()=>[0===u.childImgArr.length?((0,i.uX)(),(0,i.Wv)(k,{key:0,"image-size":200})):(0,i.Q3)("",!0),(0,i.Lk)("div",a,[((0,i.uX)(!0),(0,i.CE)(i.FK,null,(0,i.pI)(u.childImgArr,(e,s)=>((0,i.uX)(),(0,i.CE)("div",{key:s,class:"img-display-item"},[(0,i.bF)(g,{class:"img-divider"},{default:(0,i.k6)(()=>[l[0]||(l[0]=(0,i.eW)(" 第",-1)),(0,i.Lk)("span",n,(0,t.v_)(e.id),1),l[1]||(l[1]=(0,i.eW)("组 ",-1))]),_:2},1024),(0,i.Lk)("div",null,[(0,i.bF)(m,{ref_for:!0,ref:"tableTab",class:"img-display",src:e.before_img,fit:u.fit,lazy:!0,"preview-src-list":[e.before_img],"preview-teleported":!0},null,8,["src","fit","preview-src-list"]),l[2]||(l[2]=(0,i.Lk)("div",{class:"img-infor"},[(0,i.Lk)("span",null,"原图")],-1))]),(0,i.Lk)("div",null,["场景分类"!==e.type?((0,i.uX)(),(0,i.CE)("div",o,[(0,i.bF)(m,{ref_for:!0,ref:"tableTab",class:"img-display",src:e.after_img,fit:u.fit,lazy:!0,"preview-src-list":[e.after_img],"preview-teleported":!0},null,8,["src","fit","preview-src-list"]),(0,i.Lk)("div",c,[l[4]||(l[4]=(0,i.Lk)("span",null,"预测结果",-1)),(0,i.Lk)("span",{onClick:l=>f.downloadimgWithWords(e.id,e.after_img,`${e.type}结果图.png`)},[...l[3]||(l[3]=[(0,i.Lk)("i",{class:"iconfont icon-xiazai"},null,-1)])],8,r)])])):((0,i.uX)(),(0,i.CE)("div",d,[(0,i.Lk)("span",h,(0,t.v_)(Object.keys(e.data)[0])+": "+(0,t.v_)(e.data[Object.keys(e.data)]),1)]))])]))),128))])]),_:1})}var u=s(3361),f={name:"Imgshow",props:{imgArr:{type:Array,default(){return[]}}},data(){return{fit:"fill",childImgArr:[]}},mounted(){this.childImgArr=this.imgArr},updated(){this.childImgArr=this.imgArr},methods:{downloadimgWithWords:u.Lf}},k=s(1241);const g=(0,k.A)(f,[["render",p],["__scopeId","data-v-45290c92"]]);var m=g}}]);
//# sourceMappingURL=141.b990f8e5.js.map