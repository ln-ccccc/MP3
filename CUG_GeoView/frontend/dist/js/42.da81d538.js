"use strict";(self["webpackChunkgeoview"]=self["webpackChunkgeoview"]||[]).push([[42],{1818:function(e,l,s){s.d(l,{Mx:function(){return a},dx:function(){return o},nK:function(){return c},sw:function(){return n}});s(8111),s(2489),s(1701);var i=s(9857),t=s(3212);function a(e){if(0===this.fileList.length)4===this.uploadSrc.prehandle?(this.$refs.sharpen.checked=!1,this.uploadSrc.prehandle=0):(this.$refs.sharpen.checked=!1,this.$message.error("请先上传图片"));else if(!0===this.$refs.clahe.checked&&(this.$refs.clahe.checked=!1),!1===this.$refs.sharpen.checked)this.$message.success("取消锐化处理"),this.uploadSrc.prehandle=0;else{this.$message.success("锐化处理"),this.uploadSrc.prehandle=4;let l=new FormData;for(const s of this.fileList)l.append("files",s)||l.append("files",s.raw),l.append("type",e);(0,i.Dr)(l).then(e=>{this.uploadSrc.list=e.data.data.map(e=>t.A.BASEURL+e.src),this.before=this.uploadSrc.list.splice(0,3),this.prePhoto.list=this.before,this.prePhoto.prehandle=4,(0,i.WS)(this.prePhoto).then(e=>{this.sharpenImg=e.data.data.map(e=>t.A.BASEURL+e)}).catch(()=>{})}).catch(e=>{})}}function n(e){if(0===this.fileList.length)2===this.uploadSrc.prehandle?(this.$refs.clahe.checked=!1,this.uploadSrc.prehandle=0):(this.$refs.clahe.checked=!1,this.$message.error("请先上传图片"));else if(!0===this.$refs.sharpen.checked&&(this.$refs.sharpen.checked=!1),!1===this.$refs.clahe.checked)this.$message.success("取消CLAHE处理"),this.uploadSrc.prehandle=0;else{this.$message.success("CLAHE处理"),this.uploadSrc.prehandle=2;let l=new FormData;for(const s of this.fileList)l.append("files",s)||l.append("files",s.raw),l.append("type",e);(0,i.Dr)(l).then(e=>{this.uploadSrc.list=e.data.data.map(e=>t.A.BASEURL+e.src),this.before=this.uploadSrc.list.splice(0,3),this.prePhoto.list=this.before,this.prePhoto.prehandle=2,(0,i.WS)(this.prePhoto).then(e=>{this.claheImg=e.data.data.map(e=>t.A.BASEURL+e)}).catch(e=>{})}).catch(e=>{})}}function o(){!0===this.$refs.smooth.checked&&(this.$refs.smooth.checked=!1),!1===this.$refs.filter.checked?(this.$message.success("取消高斯滤波处理"),this.uploadSrc.denoise=0):(this.$message.success("高斯滤波处理"),this.uploadSrc.denoise=5)}function c(){!0===this.$refs.filter.checked&&(this.$refs.filter.checked=!1),!1===this.$refs.smooth.checked?(this.$message.success("取消平滑处理"),this.uploadSrc.denoise=0):(this.$message.success("平滑处理"),this.uploadSrc.denoise=3)}},6281:function(e,l,s){s.r(l),s.d(l,{default:function(){return P}});var i=s(6768),t=s(4232);const a={key:0,class:"clear-queue"},n={class:"prehandle-label container"},o={class:"prehandle-label container"},c={class:"prehandle-label container"},r={class:"prehandle-label container"},d={class:"prehandle-label container"},h={class:"custom-model"},p={key:0},u={class:"handle-button"},f={key:2},k={key:0},m={key:1},g={class:"handle-words"},b=["onClick"],L={class:"handle-words"},v=["onClick"],y={key:0},C={class:"go-bold"};function _(e,l,s,_,w,S){const F=(0,i.g2)("Tabinfor"),A=(0,i.g2)("el-divider"),x=(0,i.g2)("el-button"),W=(0,i.g2)("el-upload"),$=(0,i.g2)("el-row"),E=(0,i.g2)("el-radio"),I=(0,i.g2)("el-image"),X=(0,i.g2)("el-col"),U=(0,i.g2)("el-card"),j=(0,i.g2)("MyVueCropper"),P=(0,i.g2)("el-dialog"),V=(0,i.g2)("ImgShow"),M=(0,i.g2)("Bottominfor");return(0,i.uX)(),(0,i.CE)("div",null,[(0,i.bF)(F,null,{left:(0,i.k6)(()=>[...l[14]||(l[14]=[(0,i.Lk)("div",{id:"sub-title"},[(0,i.eW)(" 智能目标识别"),(0,i.Lk)("i",{class:"icon-click"})],-1)])]),_:1}),(0,i.bF)(A),l[44]||(l[44]=(0,i.Lk)("p",null,[(0,i.eW)(" 请选择待识别的"),(0,i.Lk)("span",{class:"go-bold"},"影像数据文件夹"),(0,i.Lk)("i",{class:"icon-folder-new"}),(0,i.eW)("或"),(0,i.Lk)("span",{class:"go-bold"},"影像文件"),(0,i.Lk)("i",{class:"icon-upload-new"})],-1)),(0,i.bF)($,{type:"flex",justify:"center"},{default:(0,i.k6)(()=>[(0,i.bF)(X,{span:24},{default:(0,i.k6)(()=>[(0,i.bF)(U,{style:{border:"4px dashed var(--el-border-color)"}},{default:(0,i.k6)(()=>[w.fileList.length?((0,i.uX)(),(0,i.CE)("div",a,[(0,i.bF)(x,{type:"primary",class:"btn-animate2 btn-animate__surround",onClick:S.clearQueue},{default:(0,i.k6)(()=>[...l[15]||(l[15]=[(0,i.eW)(" 清空图片 ",-1)])]),_:1},8,["onClick"])])):(0,i.Q3)("",!0),(0,i.bF)(W,{ref:"upload","file-list":w.fileList,"onUpdate:fileList":l[0]||(l[0]=e=>w.fileList=e),class:"upload-card",drag:"",action:"#",multiple:"","auto-upload":!1,onChange:l[1]||(l[1]=e=>S.beforeUpload(w.fileList[w.fileList.length-1].raw))},{default:(0,i.k6)(()=>[...l[16]||(l[16]=[(0,i.Lk)("i",{class:"iconfont icon-yunduanshangchuan"},null,-1),(0,i.Lk)("div",{class:"el-upload__text"},[(0,i.eW)(" 将文件拖到此处，或"),(0,i.Lk)("em",null,"点击上传")],-1),(0,i.Lk)("div",{class:"el-upload__tip"}," 只能上传一张或多张图片，请在下方上传文件夹 ",-1)])]),_:1},8,["file-list"]),(0,i.bF)($,{justify:"center"},{default:(0,i.k6)(()=>[(0,i.Lk)("input",{id:"folder",ref:"uploadFile",type:"file",webkitdirectory:"",directory:"",multiple:"",onChange:l[2]||(l[2]=e=>S.uploadMore())},null,544),(0,i.Lk)("i",{class:"iconfont icon-wenjianshangchuan",onClick:l[3]||(l[3]=(...e)=>S.fileClick&&S.fileClick(...e))},"上传文件夹")]),_:1}),(0,i.bF)($,{justify:"center"},{default:(0,i.k6)(()=>[(0,i.Lk)("p",null,[(0,i.Lk)("label",n,[(0,i.Lk)("input",{ref:"cut",type:"checkbox",onChange:l[4]||(l[4]=e=>S.select())},null,544),l[17]||(l[17]=(0,i.Lk)("span",{class:"checkmark"},null,-1)),l[18]||(l[18]=(0,i.Lk)("span",{class:"go-bold label-words"},"上传时编辑图片",-1)),l[19]||(l[19]=(0,i.Lk)("i",{class:"iconfont icon-crop-full"},null,-1))])])]),_:1}),(0,i.bF)($,{justify:"center",align:"middle"},{default:(0,i.k6)(()=>[l[24]||(l[24]=(0,i.Lk)("i",{class:"iconfont icon-tuxingtuxiangchuli"},null,-1)),l[25]||(l[25]=(0,i.Lk)("p",null,"图像增强：",-1)),(0,i.Lk)("p",null,[(0,i.Lk)("label",o,[(0,i.Lk)("input",{ref:"clahe",type:"checkbox",onChange:l[5]||(l[5]=e=>S.selectClahe(2))},null,544),l[20]||(l[20]=(0,i.Lk)("span",{class:"checkmark"},null,-1)),l[21]||(l[21]=(0,i.Lk)("span",{class:"go-bold label-words"},"CLAHE",-1))])]),(0,i.Lk)("p",null,[(0,i.Lk)("label",c,[(0,i.Lk)("input",{ref:"sharpen",type:"checkbox",onChange:l[6]||(l[6]=e=>S.selectSharpen(2))},null,544),l[22]||(l[22]=(0,i.Lk)("span",{class:"checkmark"},null,-1)),l[23]||(l[23]=(0,i.Lk)("span",{class:"go-bold label-words"},"锐化",-1))])])]),_:1}),(0,i.bF)($,{justify:"center",align:"middle"},{default:(0,i.k6)(()=>[l[30]||(l[30]=(0,i.Lk)("i",{class:"iconfont icon-agora_AIjiangzao"},null,-1)),l[31]||(l[31]=(0,i.Lk)("p",null,"降噪处理：",-1)),(0,i.Lk)("p",null,[(0,i.Lk)("label",r,[(0,i.Lk)("input",{ref:"smooth",type:"checkbox",onChange:l[7]||(l[7]=e=>S.selectSmooth())},null,544),l[26]||(l[26]=(0,i.Lk)("span",{class:"checkmark"},null,-1)),l[27]||(l[27]=(0,i.Lk)("span",{class:"go-bold label-words"},"平滑",-1))]),(0,i.Lk)("label",d,[(0,i.Lk)("input",{ref:"filter",type:"checkbox",onChange:l[8]||(l[8]=e=>S.selectFilter())},null,544),l[28]||(l[28]=(0,i.Lk)("span",{class:"checkmark"},null,-1)),l[29]||(l[29]=(0,i.Lk)("span",{class:"go-bold label-words"},"滤波",-1))])])]),_:1}),(0,i.bF)($,{justify:"center"},{default:(0,i.k6)(()=>[(0,i.Lk)("div",h,[l[32]||(l[32]=(0,i.eW)(" 可选训练模型： ",-1)),0===w.modelPathArr.length?((0,i.uX)(),(0,i.CE)("span",p,"未检测到模型文件，请查看上传目录是否有误")):(0,i.Q3)("",!0),((0,i.uX)(!0),(0,i.CE)(i.FK,null,(0,i.pI)(w.modelPathArr,(e,s)=>((0,i.uX)(),(0,i.Wv)(E,{key:s,modelValue:w.uploadSrc.model_path,"onUpdate:modelValue":l[9]||(l[9]=e=>w.uploadSrc.model_path=e),class:"choose-item",label:e.model_path},{default:(0,i.k6)(()=>[(0,i.eW)((0,t.v_)(e.model_name),1)]),_:2},1032,["modelValue","label"]))),128))])]),_:1}),(0,i.Lk)("div",u,[(0,i.bF)(x,{type:"primary",class:"btn-animate btn-animate__shiny",onClick:l[10]||(l[10]=e=>S.upload("目标检测","object_detection"))},{default:(0,i.k6)(()=>[...l[33]||(l[33]=[(0,i.eW)(" 开始处理 ",-1)])]),_:1})]),w.uploadSrc.prehandle?(0,i.Q3)("",!0):((0,i.uX)(),(0,i.Wv)(A,{key:1})),w.uploadSrc.prehandle?((0,i.uX)(),(0,i.CE)("div",f,[2===w.uploadSrc.prehandle?((0,i.uX)(),(0,i.CE)("div",k,[...l[34]||(l[34]=[(0,i.Lk)("div",{id:"sub-title"},[(0,i.eW)(" CLAHE处理结果预览"),(0,i.Lk)("i",{class:"iconfont icon-dianji"})],-1)])])):4===w.uploadSrc.prehandle?((0,i.uX)(),(0,i.CE)("div",m,[...l[35]||(l[35]=[(0,i.Lk)("div",{id:"sub-title"},[(0,i.eW)(" 锐化处理结果预览"),(0,i.Lk)("i",{class:"iconfont icon-dianji"})],-1)])])):(0,i.Q3)("",!0),(0,i.bF)(A),(0,i.bF)($,{justify:"center",gutter:20},{default:(0,i.k6)(()=>[(0,i.bF)(X,{xs:24,sm:24,md:6,lg:6,xl:6},{default:(0,i.k6)(()=>[((0,i.uX)(!0),(0,i.CE)(i.FK,null,(0,i.pI)(w.before,(e,s)=>((0,i.uX)(),(0,i.CE)("div",{key:s},[(0,i.bF)(I,{src:e,"preview-src-list":[e],"preview-teleported":!0},null,8,["src","preview-src-list"]),l[36]||(l[36]=(0,i.Lk)("div",{class:"handle-words"}," 原图 ",-1))]))),128))]),_:1}),(0,i.bF)(X,{md:2,lg:2,xl:2}),2===w.uploadSrc.prehandle?((0,i.uX)(),(0,i.Wv)(X,{key:0,xs:24,sm:24,md:6,lg:6,xl:6},{default:(0,i.k6)(()=>[((0,i.uX)(!0),(0,i.CE)(i.FK,null,(0,i.pI)(w.claheImg,(e,s)=>((0,i.uX)(),(0,i.CE)("div",{key:s},[(0,i.bF)(I,{src:e,"preview-src-list":[e],"preview-teleported":!0},null,8,["src","preview-src-list"]),(0,i.Lk)("div",g,[l[38]||(l[38]=(0,i.eW)(" CLAHE处理后 ",-1)),(0,i.Lk)("span",{onClick:l=>S.downloadimgWithWords(-1,e,"CLAHE处理图.png")},[...l[37]||(l[37]=[(0,i.Lk)("i",{class:"iconfont icon-xiazai"},null,-1)])],8,b)])]))),128))]),_:1})):(0,i.Q3)("",!0),4===w.uploadSrc.prehandle?((0,i.uX)(),(0,i.Wv)(X,{key:1,xs:24,sm:24,md:6,lg:6,xl:6},{default:(0,i.k6)(()=>[((0,i.uX)(!0),(0,i.CE)(i.FK,null,(0,i.pI)(w.sharpenImg,(e,s)=>((0,i.uX)(),(0,i.CE)("div",{key:s},[(0,i.bF)(I,{src:e,"preview-src-list":[e],"preview-teleported":!0},null,8,["src","preview-src-list"]),(0,i.Lk)("div",L,[l[40]||(l[40]=(0,i.eW)(" 锐化处理后 ",-1)),(0,i.Lk)("span",{onClick:l=>S.downloadimgWithWords(-1,e,"锐化处理图.png")},[...l[39]||(l[39]=[(0,i.Lk)("i",{class:"iconfont icon-xiazai"},null,-1)])],8,v)])]))),128))]),_:1})):(0,i.Q3)("",!0)]),_:1})])):(0,i.Q3)("",!0)]),_:1})]),_:1})]),_:1}),(0,i.bF)(F,null,{left:(0,i.k6)(()=>[...l[41]||(l[41]=[(0,i.Lk)("div",{id:"sub-title"},[(0,i.eW)(" 结果图预览"),(0,i.Lk)("i",{class:"iconfont icon-dianji"})],-1)])]),_:1}),(0,i.bF)(A),(0,i.bF)(F,null,{left:(0,i.k6)(()=>[...l[42]||(l[42]=[(0,i.Lk)("p",null,[(0,i.Lk)("span",{class:"go-bold"},"点击图片"),(0,i.eW)("即可预览 "),(0,i.Lk)("i",{class:"iconfont icon-duigou"}),(0,i.Lk)("span",null,[(0,i.Lk)("span",{class:"go-bold"},"滑轮滚动"),(0,i.eW)("即可放大缩小")])],-1)])]),mid:(0,i.k6)(()=>[w.isUpload?((0,i.uX)(),(0,i.CE)("p",y,[(0,i.Lk)("i",{class:"iconfont icon-dabaoxiazai",onClick:l[11]||(l[11]=e=>S.goCompress("目标检测"))},"结果图打包")])):(0,i.Q3)("",!0)]),right:(0,i.k6)(()=>[(0,i.Lk)("span",C,[(0,i.Lk)("i",{class:"iconfont icon-shuaxin",style:{"padding-right":"55px"},onClick:l[12]||(l[12]=(...e)=>S.getMore&&S.getMore(...e))},[...l[43]||(l[43]=[(0,i.Lk)("span",{class:"hidden-sm-and-down"},"点击刷新",-1)])])])]),_:1}),(0,i.bF)(P,{modelValue:w.cutVisible,"onUpdate:modelValue":l[13]||(l[13]=e=>w.cutVisible=e),modal:!1,title:"编辑",width:"75%",top:"0"},{default:(0,i.k6)(()=>[(0,i.bF)(j,{fileimg:w.fileimg,funtype:w.funtype,file:w.file,child_prehandle:w.uploadSrc.prehandle,child_denoise:w.uploadSrc.denoise,"child-model-path":w.uploadSrc.model_path,onCutChanged:S.notvisible,onChildRefresh:S.getMore},null,8,["fileimg","funtype","file","child_prehandle","child_denoise","child-model-path","onCutChanged","onChildRefresh"])]),_:1},8,["modelValue"]),(0,i.bF)(V,{"img-arr":w.imgArr},null,8,["img-arr"]),(0,i.bF)(M)])}s(4114),s(4603),s(7566),s(8721);var w=s(3361),S=s(9857),F=s(2564),A=s(121),x=s(1818),W=s(7901),$=s(104),E=s(3490),I=s(6926),X={name:"Detectobjects",components:{ImgShow:W.A,Tabinfor:$.A,Bottominfor:E.A,MyVueCropper:I.A},beforeRouteEnter(e,l,s){s(e=>{document.querySelector(".el-main").scrollTop=0})},data(){return{isUpload:!0,canUpload:!0,claheImg:[],sharpenImg:[],before:[],fileimg:"",file:{},isNotCut:!0,cutVisible:!1,funtype:"目标检测",scrollTop:"",fit:"fill",fileList:[],uploadSrc:{list:[],prehandle:0,denoise:0,model_path:""},modelPathArr:[],prePhoto:{list:[],prehandle:0,type:4},imgArr:[]}},watch:{uploadSrc:{handler(e,l){this.uploadSrc=e},deep:!0,immediate:!0}},created(){this.getUploadImg("目标检测"),this.getCustomModel("object_detection").then(e=>{this.modelPathArr=e.data.data,this.uploadSrc.model_path=this.modelPathArr[0]?.model_path}).catch(e=>{})},methods:{getImgArrayBuffer:w.h0,atchDownload:w.hz,downloadimgWithWords:w.Lf,imgUpload:S.vh,getCustomModel:S.bB,historyGetPage:F.q,createSrc:S.Dr,getUploadImg:A.Be,upload:A.Se,goCompress:A.xX,selectSharpen:x.Mx,selectFilter:x.dx,selectSmooth:x.nK,selectClahe:x.sw,checkUpload(){this.isUpload=0!==this.afterImg.length},clearQueue(){this.fileList=[],this.$message.success("清除成功")},notvisible(){this.cutVisible=!1,this.fileList=[]},getMore(){this.getUploadImg("目标检测")},uploadMore(){this.beforeUpload(...this.$refs.uploadFile.files),this.canUpload?this.fileList.push(...this.$refs.uploadFile.files):setTimeout(()=>{this.$message.error("检测到您上传的文件夹内存在不符合规范的图片类型")},1e3)},fileClick(){document.querySelector("#folder").click()},beforeUpload(e){this.cutVisible=this.$refs.cut.checked;const l=e.name.substring(e.name.lastIndexOf(".")+1),s=["jpg","jpeg","png","JPG","JPEG"];-1===s.indexOf(l)?(this.$message.error("只允许上传jpg, jpeg, png, JPG, 或JPEG格式,请重新上传"),this.fileList=[],this.canUpload=!1,this.cutVisible=!1):(this.canUpload=!0,this.fileimg=window.URL.createObjectURL(new Blob([e])))},select(){this.isNotCut=this.$refs.cut.checked}}},U=s(1241);const j=(0,U.A)(X,[["render",_],["__scopeId","data-v-9123a964"]]);var P=j},7901:function(e,l,s){s.d(l,{A:function(){return g}});var i=s(6768),t=s(4232);const a={class:"img-display-box"},n={class:"index-number"},o={key:0},c={class:"img-infor"},r=["onClick"],d={key:1,class:"img-index"},h={class:"index-number"};function p(e,l,s,p,u,f){const k=(0,i.g2)("el-empty"),m=(0,i.g2)("el-divider"),g=(0,i.g2)("el-image"),b=(0,i.g2)("el-card");return(0,i.uX)(),(0,i.Wv)(b,{style:{"margin-bottom":"10px"}},{default:(0,i.k6)(()=>[0===u.childImgArr.length?((0,i.uX)(),(0,i.Wv)(k,{key:0,"image-size":200})):(0,i.Q3)("",!0),(0,i.Lk)("div",a,[((0,i.uX)(!0),(0,i.CE)(i.FK,null,(0,i.pI)(u.childImgArr,(e,s)=>((0,i.uX)(),(0,i.CE)("div",{key:s,class:"img-display-item"},[(0,i.bF)(m,{class:"img-divider"},{default:(0,i.k6)(()=>[l[0]||(l[0]=(0,i.eW)(" 第",-1)),(0,i.Lk)("span",n,(0,t.v_)(e.id),1),l[1]||(l[1]=(0,i.eW)("组 ",-1))]),_:2},1024),(0,i.Lk)("div",null,[(0,i.bF)(g,{ref_for:!0,ref:"tableTab",class:"img-display",src:e.before_img,fit:u.fit,lazy:!0,"preview-src-list":[e.before_img],"preview-teleported":!0},null,8,["src","fit","preview-src-list"]),l[2]||(l[2]=(0,i.Lk)("div",{class:"img-infor"},[(0,i.Lk)("span",null,"原图")],-1))]),(0,i.Lk)("div",null,["场景分类"!==e.type?((0,i.uX)(),(0,i.CE)("div",o,[(0,i.bF)(g,{ref_for:!0,ref:"tableTab",class:"img-display",src:e.after_img,fit:u.fit,lazy:!0,"preview-src-list":[e.after_img],"preview-teleported":!0},null,8,["src","fit","preview-src-list"]),(0,i.Lk)("div",c,[l[4]||(l[4]=(0,i.Lk)("span",null,"预测结果",-1)),(0,i.Lk)("span",{onClick:l=>f.downloadimgWithWords(e.id,e.after_img,`${e.type}结果图.png`)},[...l[3]||(l[3]=[(0,i.Lk)("i",{class:"iconfont icon-xiazai"},null,-1)])],8,r)])])):((0,i.uX)(),(0,i.CE)("div",d,[(0,i.Lk)("span",h,(0,t.v_)(Object.keys(e.data)[0])+": "+(0,t.v_)(e.data[Object.keys(e.data)]),1)]))])]))),128))])]),_:1})}var u=s(3361),f={name:"Imgshow",props:{imgArr:{type:Array,default(){return[]}}},data(){return{fit:"fill",childImgArr:[]}},mounted(){this.childImgArr=this.imgArr},updated(){this.childImgArr=this.imgArr},methods:{downloadimgWithWords:u.Lf}},k=s(1241);const m=(0,k.A)(f,[["render",p],["__scopeId","data-v-45290c92"]]);var g=m}}]);
//# sourceMappingURL=42.da81d538.js.map